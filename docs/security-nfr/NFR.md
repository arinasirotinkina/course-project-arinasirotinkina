# NFR.md — Нефункциональные требования для Wishlist API

| ID         | Название | Описание | Метрика/Порог | Проверка (чем/где) | Компонент | Приоритет |
|------------|----------|----------|---------------|--------------------|-----------|-----------|
| **NFR-01** | Время ответа (p95) | Время ответа API для пользовательских read-эндпоинтов (GET /wishes, GET /wishes/{id}) должно быть низким для хорошего UX | p95 ≤ 200 мс при нормальной нагрузке (до 200 RPS) | Нагрузочное тестирование (k6/Locust); метрика p95 в Prometheus/Grafana | API (wishes) | Высокий |
| **NFR-02** | Время ответа при пиковых нагрузках | Время ответа API под пиковыми нагрузками не должно деградировать критично | p95 ≤ 500 мс при 1000 RPS | Стресс-тестирование (k6); анализ p95/p99 в Grafana | API, Инфраструктура | Высокий |
| **NFR-03** | Доступность (SLA) | Доступность сервиса должна быть высокой для пользователей | SLA ≥ 99.9 % (месячная доступность) | Мониторинг uptime — Prometheus Alertmanager / UptimeRobot / Pingdom | Инфраструктура, API | Высокий |
| **NFR-04** | Процент ошибок | Доля ошибочных ответов (5xx) должна оставаться низкой | 5xx ≤ 0.5 % в сутки; 4xx ≤ 3 % (исключая валидации) | Метрики ошибок в Prometheus; логи в ELK / Graylog | API, Middleware | Высокий |
| **NFR-05** | Время исправления уязвимостей | Критические и High-уязвимости должны устраняться оперативно | High/Critical ≤ 7 дней; Medium ≤ 30 дней | Автосканы Snyk/Trivy; отчёты в CI | Security / CI | Высокий |
| **NFR-06** | Безопасная аутентификация (JWT) | Токены должны иметь ограниченный срок жизни и ротацию | Access JWT TTL ≤ 24 ч; Refresh TTL ≤ 30 дней | Проверка конфигурации; e2e тесты на просроченные токены | Auth / API | Средний |
| **NFR-07** | Сохранность данных (бэкапы) | Обеспечить резервное копирование и восстановление данных | RPO ≤ 1 ч; RTO ≤ 1 ч | Тестовое восстановление раз в неделю; отчёт в CI/Ops | Database / Storage | Высокий |
| **NFR-08** | Ограничения запросов (rate limiting) | Предотвратить злоупотребления API и перегрузки | 10 RPS на пользователя; глобальный burst ≤ 2000 RPS | Тест на rate-limit; метрики в Prometheus | API Gateway / Middleware | Высокий |
| **NFR-09** | Пул соединений к БД | Гарантировать стабильность при нагрузке | Время ожидания подключения ≤ 1 с; pool usage ≤ 90 % | Мониторинг pool в Prometheus; нагрузочные тесты | Database | Средний |
| **NFR-10** | Покрытие тестами | Минимизировать регрессии через автотесты | Unit тесты ≥ 80 %; CRUD тесты = 100 % основных сценариев | pytest-cov в CI; отчёт coverage | CI / QA / Codebase | Средний |
---
